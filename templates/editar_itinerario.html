<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar Itinerario - TRAVELASIA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #1a56db;
            --secondary-color: #7e3af2;
            --accent-color: #0694a2;
            --light-bg: #f8fafc;
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --card-radius: 12px;
        }

        body {
            background-color: var(--light-bg);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: #1f2937;
            line-height: 1.6;
        }

        /* HEADER STYLE */
        .travelasia-header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px 0;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .brand-logo {
            font-size: 2rem;
            font-weight: 800;
            letter-spacing: -0.5px;
        }

        .brand-logo i {
            margin-right: 10px;
        }

        /* CARD STYLES */
        .travelasia-card {
            background: white;
            border-radius: var(--card-radius);
            box-shadow: var(--card-shadow);
            border: none;
            overflow: hidden;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .travelasia-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .card-header-modern {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-bottom: none;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .card-header-modern i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        /* FORM CONTROLS */
        .form-label-modern {
            font-weight: 600;
            color: #374151;
            font-size: 0.95rem;
            margin-bottom: 8px;
        }

        .form-control-modern {
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 12px 16px;
            font-size: 1rem;
            transition: all 0.3s;
            background-color: white;
        }

        .form-control-modern:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(26, 86, 219, 0.1);
            outline: none;
        }

        .form-control-modern-lg {
            padding: 16px 20px;
            font-size: 1.1rem;
        }

        /* BUTTONS */
        .btn-travelasia {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .btn-travelasia:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(26, 86, 219, 0.2);
            color: white;
        }

        .btn-travelasia-outline {
            background: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-travelasia-outline:hover {
            background: var(--primary-color);
            color: white;
        }

        .btn-travelasia-danger {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
        }

        .btn-travelasia-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(220, 38, 38, 0.2);
            color: white;
        }

        /* COUNTRY BADGES */
        .country-badge-modern {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: 20px;
            font-weight: 500;
            margin-right: 10px;
            margin-bottom: 10px;
            border: 2px solid #bae6fd;
        }

        .country-flag-large {
            font-size: 1.5rem;
            margin-right: 8px;
        }

        /* PRICE DISPLAY */
        .price-display-modern {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 15px 30px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1.3rem;
            display: inline-block;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        /* STATUS BADGES */
        .status-badge-modern {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            display: inline-block;
        }

        .status-planning { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; }
        .status-confirmed { background: linear-gradient(135deg, #10b981, #059669); color: white; }
        .status-in-progress { background: linear-gradient(135deg, #3b82f6, #1d4ed8); color: white; }
        .status-completed { background: linear-gradient(135deg, #6b7280, #4b5563); color: white; }

        /* DAY SECTION */
        .day-section-modern {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border-left: 5px solid var(--primary-color);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            position: relative;
        }

        .day-number {
            position: absolute;
            top: -15px;
            left: -15px;
            background: var(--primary-color);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        /* ACTIVITY ROW */
        .activity-row-modern {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid var(--accent-color);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        /* PROGRESS BARS */
        .progress-modern {
            height: 10px;
            border-radius: 10px;
            background-color: #e5e7eb;
            overflow: hidden;
        }

        .progress-bar-modern {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 10px;
        }

        /* FOOTER */
        .travelasia-footer {
            background: linear-gradient(135deg, #111827, #1f2937);
            color: #9ca3af;
            padding: 25px 0;
            margin-top: 50px;
            font-size: 0.9rem;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .travelasia-header {
                padding: 20px 0;
            }
            
            .brand-logo {
                font-size: 1.5rem;
            }
            
            .day-section-modern {
                padding: 20px 15px;
            }
            
            .price-display-modern {
                font-size: 1.1rem;
                padding: 12px 20px;
            }
        }

        /* ANIMATIONS */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <div class="travelasia-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <div class="brand-logo">
                        <i class="fas fa-globe-asia"></i>TRAVELASIA
                    </div>
                    <h1 class="h3 mt-3 mb-2">
                        <i class="fas fa-edit me-2"></i>Editar Itinerario
                    </h1>
                    <div class="d-flex align-items-center flex-wrap mt-3">
                        <h4 class="mb-0 me-3" id="itinerario-nombre">{{ nombre_itinerario }}</h4>
                        
                        <span id="estado-badge" class="status-badge-modern me-3 
                            {% if estado == 'planificando' %}status-planning
                            {% elif estado == 'confirmado' %}status-confirmed
                            {% elif estado == 'en_progreso' %}status-in-progress
                            {% elif estado == 'completado' %}status-completed
                            {% else %}status-planning{% endif %}">
                            {% if estado %}{{ estado|title }}{% else %}Planificando{% endif %}
                        </span>
                        
                        <span class="country-badge-modern me-3">
                            <i class="fas fa-flag me-1"></i>
                            <span id="numero-paises">{{ numero_paises }}</span> pa√≠ses
                        </span>
                        
                        <span class="country-badge-modern">
                            <i class="fas fa-calendar-alt me-1"></i>
                            <span id="total-dias">{{ total_dias }}</span> d√≠as
                        </span>
                    </div>
                </div>
                <div class="col-md-4 text-md-end mt-3 mt-md-0">
                    <div class="price-display-modern" id="presupuesto-total">
                        ${{ "%.2f"|format(presupuesto_total) if presupuesto_total is defined else "0.00" }}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- FORMULARIO PRINCIPAL -->
    <div class="container animate-fade-in">
        <form action="/itinerario/editar/{{ itinerario_id }}" method="POST" id="form-editar-itinerario">
            <input type="hidden" name="itinerario_id" value="{{ itinerario_id }}">
            
            <!-- SECCI√ìN 1: INFORMACI√ìN GENERAL -->
            <div class="travelasia-card">
                <div class="card-header-modern">
                    <i class="fas fa-info-circle"></i>Informaci√≥n General
                </div>
                <div class="card-body p-4">
                    <div class="row">
                        <div class="col-md-6 mb-4">
                            <label class="form-label-modern">Nombre del Itinerario *</label>
                            <input type="text" class="form-control-modern form-control-modern-lg" 
                                   name="nombre" 
                                   value="{{ nombre_itinerario }}" 
                                   placeholder="Ej: Aventura por el Sudeste Asi√°tico"
                                   required>
                        </div>
                        <div class="col-md-3 mb-4">
                            <label class="form-label-modern">Duraci√≥n Total *</label>
                            <div class="input-group">
                                <input type="number" class="form-control-modern" 
                                       name="duracion_total" 
                                       value="{{ total_dias }}"
                                       min="1" max="60" required>
                                <span class="input-group-text" style="background: #f8fafc; border: 2px solid #e5e7eb; border-left: none;">d√≠as</span>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <label class="form-label-modern">Presupuesto Total *</label>
                            <div class="input-group">
                                <span class="input-group-text" style="background: #f8fafc; border: 2px solid #e5e7eb; border-right: none;">$</span>
                                <input type="number" class="form-control-modern" id="presupuesto-total-input"
                                       name="presupuesto_total" 
                                       value="{{ "%.2f"|format(presupuesto_total) if presupuesto_total is defined else '1000.00' }}"
                                       step="0.01" min="100" required>
                            </div>
                            <small class="text-muted mt-1 d-block">M√≠nimo: $100.00</small>
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <label class="form-label-modern">Fecha de Inicio *</label>
                            <input type="date" class="form-control-modern" 
                                   name="fecha_inicio" 
                                   value="{{ fecha_inicio }}"
                                   required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label-modern">Fecha de Fin *</label>
                            <input type="date" class="form-control-modern" 
                                   name="fecha_fin" 
                                   value="{{ fecha_fin }}"
                                   required>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="form-label-modern">Descripci√≥n</label>
                        <textarea class="form-control-modern" name="descripcion" rows="3" 
                                  placeholder="Describe tu viaje, tus intereses, lo que esperas experimentar...">{{ descripcion }}</textarea>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label-modern">Estado del Itinerario</label>
                        <select class="form-control-modern" name="estado">
                            <option value="planificando" {% if estado == 'planificando' %}selected{% endif %}>üü° Planificando</option>
                            <option value="confirmado" {% if estado == 'confirmado' %}selected{% endif %}>üü¢ Confirmado</option>
                            <option value="en_progreso" {% if estado == 'en_progreso' %}selected{% endif %}>üîµ En Progreso</option>
                            <option value="completado" {% if estado == 'completado' %}selected{% endif %}>‚ö´ Completado</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- SECCI√ìN 2: PA√çSES -->
            <div class="travelasia-card">
                <div class="card-header-modern d-flex justify-content-between align-items-center">
                    <div>
                        <i class="fas fa-flag"></i>Pa√≠ses del Itinerario
                    </div>
                    <a href="/itinerario/{{ itinerario_id }}/agregar-pais" class="btn btn-travelasia btn-sm">
                        <i class="fas fa-plus me-1"></i>Agregar Pa√≠s
                    </a>
                </div>
                <div class="card-body p-4">
                    {% if paises %}
                        {% for pais in paises %}
                        <div class="mb-4 p-4" style="background: linear-gradient(135deg, #f8fafc, #f1f5f9); border-radius: 10px;">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div class="d-flex align-items-center">
                                    <span class="country-flag-large me-3">
                                        {% if pais.nombre == 'Jap√≥n' %}üáØüáµ
                                        {% elif pais.nombre == 'Corea del Sur' %}üá∞üá∑
                                        {% elif pais.nombre == 'Tailandia' %}üáπüá≠
                                        {% elif pais.nombre == 'Vietnam' %}üáªüá≥
                                        {% elif pais.nombre == 'China' %}üá®üá≥
                                        {% elif pais.nombre == 'Indonesia' %}üáÆüá©
                                        {% elif pais.nombre == 'Malasia' %}üá≤üáæ
                                        {% elif pais.nombre == 'Singapur' %}üá∏üá¨
                                        {% elif pais.nombre == 'India' %}üáÆüá≥
                                        {% elif pais.nombre == 'Filipinas' %}üáµüá≠
                                        {% elif pais.nombre == 'Camboya' %}üá∞üá≠
                                        {% elif pais.nombre == 'Laos' %}üá±üá¶
                                        {% else %}üá∫üá≥{% endif %}
                                    </span>
                                    <h5 class="mb-0 fw-bold">{{ pais.nombre }}</h5>
                                </div>
                                <a href="/itinerario/{{ itinerario_id }}/eliminar-pais/{{ pais.id }}" 
                                   class="btn btn-sm btn-travelasia-danger"
                                   onclick="return confirm('¬øEliminar {{ pais.nombre }} del itinerario?')">
                                    <i class="fas fa-times"></i>
                                </a>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label class="form-label-modern">D√≠as en {{ pais.nombre }}</label>
                                    <input type="number" class="form-control-modern" 
                                           name="dias_{{ pais.id }}" 
                                           value="{{ pais.dias }}"
                                           min="1" max="30">
                                </div>
                                
                                <div class="col-md-4 mb-3">
                                    <label class="form-label-modern">Presupuesto para {{ pais.nombre }}</label>
                                    <div class="input-group">
                                        <span class="input-group-text" style="background: #f8fafc; border: 2px solid #e5e7eb; border-right: none;">$</span>
                                        <input type="number" class="form-control-modern" 
                                               name="presupuesto_{{ pais.id }}" 
                                               value="{{ "%.2f"|format(pais.presupuesto) if pais.presupuesto else '0.00' }}"
                                               step="0.01">
                                    </div>
                                </div>
                                
                                <div class="col-md-4 mb-3">
                                    <label class="form-label-modern">Orden de Visita</label>
                                    <input type="number" class="form-control-modern" 
                                           name="orden_{{ pais.id }}" 
                                           value="{{ pais.orden }}"
                                           min="1" max="10">
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label-modern">Ciudades en {{ pais.nombre }}</label>
                                <textarea class="form-control-modern" name="ciudades_{{ pais.id }}" rows="2"
                                          placeholder="Ej: Tokio, Kioto, Osaka (separadas por comas)">{{ pais.ciudades|join(', ') if pais.ciudades else '' }}</textarea>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label-modern">Notas para {{ pais.nombre }}</label>
                                <textarea class="form-control-modern" name="notas_{{ pais.id }}" rows="2"
                                          placeholder="Actividades espec√≠ficas, lugares que visitar...">{{ pais.notas if pais.notas else '' }}</textarea>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                    <div class="text-center py-5">
                        <i class="fas fa-flag fa-4x text-muted mb-4"></i>
                        <p class="text-muted mb-4">No hay pa√≠ses agregados a este itinerario</p>
                        <a href="/itinerario/{{ itinerario_id }}/agregar-pais" class="btn btn-travelasia">
                            <i class="fas fa-plus me-2"></i>Agregar Primer Pa√≠s
                        </a>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- SECCI√ìN 3: D√çAS -->
            <div class="travelasia-card">
                <div class="card-header-modern d-flex justify-content-between align-items-center">
                    <div>
                        <i class="fas fa-calendar-alt"></i>Itinerario Diario
                    </div>
                    <a href="/itinerario/{{ itinerario_id }}/agregar-dia" class="btn btn-travelasia btn-sm">
                        <i class="fas fa-plus me-1"></i>Agregar D√≠a
                    </a>
                </div>
                <div class="card-body p-4">
                    {% if dias %}
                        {% for dia in dias %}
                        <div class="day-section-modern">
                            <div class="day-number">{{ dia.numero }}</div>
                            
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="mb-0 fw-bold">
                                    <i class="fas fa-calendar-day me-2"></i>
                                    D√≠a {{ dia.numero }}: {{ dia.titulo }}
                                </h5>
                                <a href="/itinerario/{{ itinerario_id }}/eliminar-dia/{{ dia.numero }}" 
                                   class="btn btn-sm btn-travelasia-danger"
                                   onclick="return confirm('¬øEliminar D√≠a {{ dia.numero }}?')">
                                    <i class="fas fa-trash"></i>
                                </a>
                            </div>
                            
                            <div class="row mb-4">
                                <div class="col-md-4">
                                    <label class="form-label-modern">Pa√≠s del D√≠a</label>
                                    <select class="form-control-modern" name="dia{{ dia.numero }}_pais">
                                        <option value="">Seleccionar pa√≠s...</option>
                                        {% for pais in paises %}
                                        <option value="{{ pais.id }}" {% if dia.pais_id == pais.id %}selected{% endif %}>
                                            {{ pais.nombre }}
                                        </option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label-modern">Ciudad Principal</label>
                                    <input type="text" class="form-control-modern" 
                                           name="dia{{ dia.numero }}_ciudad" 
                                           value="{{ dia.ciudad }}"
                                           placeholder="Ej: Tokio, Se√∫l, Bangkok...">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label-modern">Hotel/Alojamiento</label>
                                    <input type="text" class="form-control-modern" 
                                           name="dia{{ dia.numero }}_hotel" 
                                           value="{{ dia.hotel }}"
                                           placeholder="Nombre del hotel...">
                                </div>
                            </div>
                            
                            <h6 class="form-label-modern mb-3">Actividades del D√≠a {{ dia.numero }}</h6>
                            
                            {% if dia.actividades %}
                                {% for actividad in dia.actividades %}
                                <div class="activity-row-modern mb-3">
                                    <div class="row align-items-center">
                                        <div class="col-md-2 mb-3">
                                            <label class="form-label-modern small">Hora</label>
                                            <input type="time" class="form-control-modern" 
                                                   name="dia{{ dia.numero }}_act{{ loop.index }}_hora"
                                                   value="{{ actividad.hora }}">
                                        </div>
                                        <div class="col-md-8 mb-3">
                                            <label class="form-label-modern small">Actividad</label>
                                            <input type="text" class="form-control-modern" 
                                                   name="dia{{ dia.numero }}_act{{ loop.index }}_nombre"
                                                   value="{{ actividad.nombre }}"
                                                   placeholder="Nombre de la actividad">
                                        </div>
                                        <div class="col-md-2 mb-3 text-end">
                                            <a href="/itinerario/{{ itinerario_id }}/dia/{{ dia.numero }}/eliminar-actividad/{{ loop.index }}" 
                                               class="btn btn-sm btn-travelasia-danger"
                                               onclick="return confirm('¬øEliminar esta actividad?')">
                                                <i class="fas fa-times"></i>
                                            </a>
                                        </div>
                                        <div class="col-12">
                                            <label class="form-label-modern small">Descripci√≥n</label>
                                            <textarea class="form-control-modern" 
                                                      name="dia{{ dia.numero }}_act{{ loop.index }}_descripcion"
                                                      rows="2"
                                                      placeholder="Detalles de la actividad...">{{ actividad.descripcion }}</textarea>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            {% endif %}
                            
                            <div class="text-center mt-4">
                                <a href="/itinerario/{{ itinerario_id }}/dia/{{ dia.numero }}/agregar-actividad" 
                                   class="btn btn-travelasia-outline">
                                    <i class="fas fa-plus me-1"></i>Agregar Actividad al D√≠a {{ dia.numero }}
                                </a>
                            </div>
                            
                            <div class="mt-4">
                                <label class="form-label-modern">Notas del D√≠a {{ dia.numero }}</label>
                                <textarea class="form-control-modern" 
                                          name="dia{{ dia.numero }}_notas"
                                          rows="2"
                                          placeholder="Notas importantes para este d√≠a...">{{ dia.notas }}</textarea>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                    <div class="text-center py-5">
                        <i class="fas fa-calendar fa-4x text-muted mb-4"></i>
                        <p class="text-muted mb-4">No hay d√≠as planificados en este itinerario</p>
                        <a href="/itinerario/{{ itinerario_id }}/agregar-dia" class="btn btn-travelasia">
                            <i class="fas fa-plus me-2"></i>Agregar Primer D√≠a
                        </a>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- SECCI√ìN 4: PREFERENCIAS -->
            <div class="travelasia-card">
                <div class="card-header-modern">
                    <i class="fas fa-heart"></i>Preferencias del Viajero
                </div>
                <div class="card-body p-4">
                    <div class="row">
                        <div class="col-md-6 mb-4">
                            <label class="form-label-modern">Tipo de Viaje Preferido</label>
                            <select class="form-control-modern" name="tipo_viaje">
                                <option value="cultural" {% if tipo_viaje == 'cultural' %}selected{% endif %}>üèõÔ∏è Cultural e Hist√≥rico</option>
                                <option value="aventura" {% if tipo_viaje == 'aventura' %}selected{% endif %}>‚õ∞Ô∏è Aventura y Naturaleza</option>
                                <option value="relax" {% if tipo_viaje == 'relax' %}selected{% endif %}>üèñÔ∏è Relax y Playas</option>
                                <option value="gastronomia" {% if tipo_viaje == 'gastronomia' %}selected{% endif %}>üçú Gastron√≥mico</option>
                                <option value="shopping" {% if tipo_viaje == 'shopping' %}selected{% endif %}>üõçÔ∏è Shopping y Ciudades</option>
                                <option value="mixto" {% if tipo_viaje == 'mixto' %}selected{% endif %}>üåü Mixto</option>
                            </select>
                        </div>
                        
                        <div class="col-md-6 mb-4">
                            <label class="form-label-modern">Nivel de Actividad</label>
                            <select class="form-control-modern" name="nivel_actividad">
                                <option value="tranquilo" {% if nivel_actividad == 'tranquilo' %}selected{% endif %}>üòå Tranquilo</option>
                                <option value="moderado" {% if nivel_actividad == 'moderado' %}selected{% endif %}>üö∂ Moderado</option>
                                <option value="activo" {% if nivel_actividad == 'activo' %}selected{% endif %}>üèÉ Activo</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <label class="form-label-modern">Alojamiento Preferido</label>
                            <select class="form-control-modern" name="tipo_alojamiento">
                                <option value="hotel" {% if tipo_alojamiento == 'hotel' %}selected{% endif %}>üè® Hotel</option>
                                <option value="hostal" {% if tipo_alojamiento == 'hostal' %}selected{% endif %}>üõèÔ∏è Hostal</option>
                                <option value="airbnb" {% if tipo_alojamiento == 'airbnb' %}selected{% endif %}>üè† Airbnb</option>
                                <option value="resort" {% if tipo_alojamiento == 'resort' %}selected{% endif %}>üèùÔ∏è Resort</option>
                            </select>
                        </div>
                        
                        <div class="col-md-6">
                            <label class="form-label-modern">Compa√±√≠a de Viaje</label>
                            <select class="form-control-modern" name="compania_viaje">
                                <option value="solo" {% if compania_viaje == 'solo' %}selected{% endif %}>üë§ Solo</option>
                                <option value="pareja" {% if compania_viaje == 'pareja' %}selected{% endif %}>üë´ Pareja</option>
                                <option value="familia" {% if compania_viaje == 'familia' %}selected{% endif %}>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Familia</option>
                                <option value="amigos" {% if compania_viaje == 'amigos' %}selected{% endif %}>üë• Amigos</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="form-label-modern">Restricciones/Alergias Alimenticias</label>
                        <textarea class="form-control-modern" name="restricciones_alimenticias" rows="2"
                                  placeholder="Ej: Vegetariano, alergia a mariscos, sin gluten...">{{ restricciones_alimenticias if restricciones_alimenticias else '' }}</textarea>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label-modern">Notas Especiales</label>
                        <textarea class="form-control-modern" name="notas_especiales" rows="3"
                                  placeholder="Cualquier otra informaci√≥n importante...">{{ notas_especiales if notas_especiales else '' }}</textarea>
                    </div>
                </div>
            </div>

            <!-- BOTONES FINALES -->
            <div class="d-flex justify-content-between mb-5 mt-4">
                <div>
                    <a href="/" class="btn btn-travelasia-outline btn-lg">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </a>
                </div>
                <div>
                    <a href="/itinerario/eliminar/{{ itinerario_id }}" 
                       class="btn btn-travelasia-danger btn-lg me-3"
                       onclick="return confirm('¬øEst√°s SEGURO de eliminar este itinerario? Esta acci√≥n no se puede deshacer.')">
                        <i class="fas fa-trash-alt me-2"></i>Eliminar Itinerario
                    </a>
                    <button type="submit" class="btn btn-travelasia btn-lg">
                        <i class="fas fa-save me-2"></i>Guardar Cambios
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- FOOTER -->
    <footer class="travelasia-footer">
        <div class="container">
            <p class="mb-0 text-center">
                <i class="fas fa-globe-asia me-1"></i>TRAVELASIA - 
                Itinerario ID: {{ itinerario_id }} | 
                √öltima modificaci√≥n: {{ fecha_modificacion if fecha_modificacion else 'Nunca' }}
            </p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Validaci√≥n JavaScript -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('form-editar-itinerario');
        const presupuestoInput = document.getElementById('presupuesto-total-input');
        
        // Validar presupuesto
        function validarPresupuesto() {
            const value = parseFloat(presupuestoInput.value);
            const isValid = !isNaN(value) && value >= 100;
            
            if (!isValid) {
                presupuestoInput.style.borderColor = '#dc2626';
                presupuestoInput.style.boxShadow = '0 0 0 3px rgba(220, 38, 38, 0.1)';
            } else {
                presupuestoInput.style.borderColor = '#10b981';
                presupuestoInput.style.boxShadow = '0 0 0 3px rgba(16, 185, 129, 0.1)';
                presupuestoInput.value = value.toFixed(2);
            }
            
            return isValid;
        }
        
        // Validar al cambiar
        presupuestoInput.addEventListener('input', validarPresupuesto);
        
        // Validar al enviar
        form.addEventListener('submit', function(event) {
            if (!validarPresupuesto()) {
                event.preventDefault();
                alert('Por favor ingresa un presupuesto v√°lido (m√≠nimo $100.00)');
                presupuestoInput.focus();
                return false;
            }
            
            if (!confirm('¬øGuardar todos los cambios del itinerario?')) {
                event.preventDefault();
                return false;
            }
            
            return true;
        });
        
        // Inicializar valor si est√° vac√≠o
        if (!presupuestoInput.value || parseFloat(presupuestoInput.value) === 0) {
            presupuestoInput.value = "1000.00";
        }
        
        // Animaci√≥n suave al cargar
        document.querySelectorAll('.travelasia-card').forEach((card, index) => {
            card.style.animationDelay = `${index * 0.1}s`;
        });
    });
    </script>
</body>
</html>